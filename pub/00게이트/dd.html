<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Circle Sequence - GSAP ScrollTrigger</title>

    <!-- GSAP 3.12.2 + ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
      :root {
        --c1: #98b6d4; /* 진단 */
        --c2: #7f90b0; /* 처방 */
        --c3: #5b6e8f; /* 교수·학습 */
        --c4: #334163; /* 평가 */
        --c5: #142c4a; /* 효율적인 학원 운영 */
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        color: #fff;
      }

      /* 데모용 앞뒤 여백 */
      .spacer {
        height: 80vh;
        background: #f5f6f8;
      }

      /* 시퀀스 섹션 */
      .stage {
        position: relative;
        height: 100vh;
        background: #fff;
        overflow: hidden;
      }
      .stage__inner {
        position: relative;
        width: min(1120px, 92vw);
        height: 100%;
        margin: 0 auto;
        display: grid;
        place-items: center;
      }

      /* 원 묶음 레이어 */
      .stack {
        position: relative;
        width: min(900px, 88vw);
        height: min(520px, 55vh);
      }

      .ball {
        position: absolute;
        width: min(260px, 34vw);
        aspect-ratio: 1/1;
        border-radius: 50%;
        display: grid;
        place-items: center;
        will-change: transform, opacity;
        filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.08));
      }
      .ball__label {
        font-weight: 800;
        font-size: clamp(18px, 3.2vw, 32px);
        letter-spacing: -0.02em;
        text-align: center;
        line-height: 1.2;
      }

      /* 초기 점(작은 원) */
      .dot {
        position: absolute;
        inset: 0;
        margin: auto;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--c1);
      }

      /* 각 원 기본 위치(겹치도록 살짝 오프셋) */
      .ball--1 {
        left: 0%;
        top: 50%;
        transform: translate(0, -50%);
        background: var(--c1);
      }
      .ball--2 {
        left: 18%;
        top: 52%;
        transform: translate(0, -50%);
        background: var(--c2);
      }
      .ball--3 {
        left: 36%;
        top: 54%;
        transform: translate(0, -50%);
        background: var(--c3);
      }
      .ball--4 {
        left: 54%;
        top: 56%;
        transform: translate(0, -50%);
        background: var(--c4);
      }
      .ball--5 {
        left: 72%;
        top: 58%;
        transform: translate(0, -50%);
        background: var(--c5);
      }

      /* 최종 카피(화면 가득 확장 후 나타남) */
      .final-copy {
        position: absolute;
        inset: 0;
        display: grid;
        place-items: center;
        text-align: center;
        padding: 0 6vw;
        opacity: 0;
      }
      .final-copy h2 {
        font-size: clamp(28px, 4.8vw, 56px);
        margin: 0 0 0.6rem;
        font-weight: 800;
      }
      .final-copy p {
        font-size: clamp(14px, 1.6vw, 18px);
        margin: 0.2rem 0;
        opacity: 0.95;
      }

      /* 확장되는 마지막 원을 화면 배경처럼 보이게 하기 위해 아래 레이어 생성 */
      .cover {
        position: absolute;
        inset: 0;
        background: var(--c5);
        border-radius: 50%;
        width: 40vmax;
        height: 40vmax; /* 시작은 비교적 작게 */
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%) scale(0);
        z-index: 0;
      }

      /* 접근성: 모션 최소화 설정이면 고정 상태 표시 */
      @media (prefers-reduced-motion: reduce) {
        .dot {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="spacer"></div>

    <section class="stage" id="circleSequence">
      <div class="stage__inner">
        <!-- 작은 점 -->
        <div class="dot"></div>

        <!-- 원 5개 스택 -->
        <div class="stack">
          <div class="ball ball--1"><span class="ball__label">진단</span></div>
          <div class="ball ball--2"><span class="ball__label">처방</span></div>
          <div class="ball ball--3">
            <span class="ball__label">교수·학습</span>
          </div>
          <div class="ball ball--4"><span class="ball__label">평가</span></div>
          <div class="ball ball--5">
            <span class="ball__label">효율적인<br />학원 운영</span>
          </div>
        </div>

        <!-- 화면 가득 확장 레이어 + 최종 카피 -->
        <div class="cover" aria-hidden="true"></div>
        <div class="final-copy">
          <div>
            <h2>정확한 실력 진단, 수업의 출발점이 달라집니다.</h2>
            <p>
              내신·수능 기준의 레벨 테스트로 현재 수준과 취약점을 파악합니다.
            </p>
            <p>상세한 성적 리포트로 효과적인 수업 방향을 제시합니다.</p>
          </div>
        </div>
      </div>
    </section>

    <div class="spacer"></div>

    <script>
      gsap.registerPlugin(ScrollTrigger);

      const tl = gsap.timeline({
        defaults: { ease: 'power2.out' },
        scrollTrigger: {
          trigger: '#circleSequence',
          start: 'top top',
          end: '+=' + window.innerHeight * 3, // 스크롤 길이
          scrub: true,
          pin: true,
          anticipatePin: 1,
        },
      });

      // 초기 상태 세팅
      gsap.set('.ball', { scale: 0.7, opacity: 0 });
      gsap.set('.ball--1', { scale: 0.1, opacity: 0 }); // 첫 원은 더 작게 시작
      gsap.set('.final-copy', { opacity: 0 });
      gsap.set('.cover', { scale: 0 }); // 확장 배경 원

      // 1) 점 → 첫 원 확대 + 라벨 등장
      tl.to('.dot', { scale: 0, duration: 0.15 }, 0).to(
        '.ball--1',
        { scale: 1, opacity: 1, duration: 0.45 },
        0.05
      );

      // 2) 나머지 원 2~5 순차 등장(겹치며 펼쳐짐)
      tl.to('.ball--2', { opacity: 1, scale: 1, duration: 0.35 }, '>-0.1')
        .to('.ball--3', { opacity: 1, scale: 1, duration: 0.35 }, '>-0.1')
        .to('.ball--4', { opacity: 1, scale: 1, duration: 0.35 }, '>-0.1')
        .to('.ball--5', { opacity: 1, scale: 1, duration: 0.35 }, '>-0.1');

      // 3) 다시 하나로 합쳐지는 느낌: 1~4번 원 축소/사라짐, 5번 원은 중앙으로 이동
      tl.to(
        ['.ball--1', '.ball--2', '.ball--3', '.ball--4'],
        {
          opacity: 0,
          scale: 0.6,
          duration: 0.5,
        },
        '+=0.1'
      ).to(
        '.ball--5',
        {
          left: '50%',
          top: '50%',
          xPercent: -50,
          yPercent: -50,
          duration: 0.6,
        },
        '<'
      );

      // 4) 마지막 원이 화면 전체로 확장(cover 레이어로 자연스럽게 전환)
      //    - 겹침/계단 현상 방지를 위해 cover를 키우고, 라벨은 유지
      tl.set('.cover', { zIndex: 0, transformOrigin: '50% 50%' }, '<')
        .to(
          '.cover',
          {
            scale: 10, // 화면을 덮을 만큼 크게
            duration: 1.0,
            ease: 'power2.inOut',
            onStart() {
              gsap.set('.cover', { zIndex: 0 });
            },
          },
          '>-0.1'
        )
        // 확장 중 텍스트 가독성을 위해 ball--5 라벨은 잠시 감춤
        .to('.ball--5 .ball__label', { opacity: 0, duration: 0.2 }, '<');

      // 5) 카피 문구 페이드 인
      tl.to('.final-copy', { opacity: 1, duration: 0.6 }, '>-0.2');

      // (선택) 섹션 하단으로 내려가며 커브처럼 보이도록 추가 스케일
      tl.to('.cover', { scale: 12, duration: 0.6, ease: 'power2' }, '>');

      // 접근성: 모션 최소화 환경에서 즉시 최종 상태
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        gsap.set('.dot', { display: 'none' });
        gsap.set('.ball', { opacity: 0 });
        gsap.set('.cover', { scale: 12 });
        gsap.set('.final-copy', { opacity: 1 });
      }
    </script>
  </body>
</html>
